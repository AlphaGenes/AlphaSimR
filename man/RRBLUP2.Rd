% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/GS.R
\name{RRBLUP2}
\alias{RRBLUP2}
\title{RR-BLUP Model 2}
\usage{
RRBLUP2(dir, traits = 1, use = "pheno", skip = 0, maxIter = 10,
  Vu = NULL, Ve = NULL, useEM = TRUE, tol = 1e-06, simParam = NULL)
}
\arguments{
\item{dir}{path to a directory with output from \code{\link{writeRecords}}}

\item{traits}{an integer indicating the trait to model or a
function of the traits returning a single value. Unlike \code{\link{RRBLUP}}, 
only univariate models are supported.}

\item{use}{train model using genetic value (\code{gv})
or phenotypes (\code{pheno}, default)}

\item{skip}{number of older records to skip}

\item{maxIter}{maximum number of iterations. Only used 
when number of traits is greater than 1.}

\item{Vu}{marker effect variance. If value is NULL, a 
reasonable starting point is chosen automatically.}

\item{Ve}{error variance. If value is NULL, a 
reasonable starting point is chosen automatically.}

\item{useEM}{use EM to solve variance components. If false, 
The initial values are considered true.}

\item{tol}{tolerance for EM algorithm convergence}

\item{simParam}{an object of \code{\link{SimParam}}}
}
\description{
Fits an RR-BLUP model for genomic predictions. This implementation is 
meant for situations where \code{\link{RRBLUP}} is too slow. Note that 
RRBLUP2 is only faster in certain situations, see details below. Most 
users should use \code{\link{RRBLUP}}.
}
\details{
The RRBLUP2 function works best when the number of markers is not 
too large. This is because it solves the RR-BLUP problem by setting 
up and solving Henderson's mixed model equations. Solving these equations 
involves a square matrix with dimensions equal to the number of fixed 
effects plus the number of random effects (markers). Whereas the \code{\link{RRBLUP}} 
function solves the RR-BLUP problem using the EMMA approach. This approach involves 
a square matrix with dimensions equal to the number of phenotypic records. This means 
that the RRBLUP2 function uses less memory than RRBLUP when the number of markers 
is approximately equal to or smaller than the number of phenotypic records. 

The RRBLUP2 function is not recommend for cases where the variance components are 
unknown. This is uses the EM algorithm to solve for unknown variance components, 
which is generally considerably slower than the EMMA approach of \code{\link{RRBLUP}}. 
The number of iterations for the EM algorith is set by maxIter. The default value 
is typically too small for convergence. When the algorithm fails to converage a 
warning is displayed, but results are given for the last iteration. These results may 
be "good enough". However we make no claim to this effect, because we can not generalize 
to all possible use cases.

The RRBLUP2 function can quickly solve the mixed model equations without estimating variance 
components. The variance components are set by defining Vu and Ve. Estimation of components 
is suppressed by setting useEM to false. This may be useful if the model is being retrained 
multiple times during the simulation. You could run \code{\link{RRBLUP}} function the first 
time the model is trained, and then use the variance components from this output for all 
future runs with the RRBLUP2 functions. Again, we can make no claim to the general robustness 
of this approach.
}
